alamo.program               = topop
plot_file		    = tests/TopOp/output

timestep		    = 0.1
stop_time		    = 1000

# amr parameters
amr.plot_int		    = 1 #10000
amr.max_level		    = 2
amr.n_cell		    = 64 32 32
amr.blocking_factor	    = 4
amr.regrid_int		    = 1
amr.grid_eff		    = 1.0
amr.node.all = 1

amr.thermo.plot_dt = 0.1

# geometry
geometry.prob_lo	    = 0 0 0
geometry.prob_hi	    = 1.8 1 1
geometry.is_periodic	    = 0 0 0

psi.ic.type = constant
psi.ic.constant.value = 1.0
psi.bc.type.xhi = NEUMANN
psi.bc.type.xlo = NEUMANN
psi.bc.type.yhi = NEUMANN
psi.bc.type.ylo = NEUMANN
psi.bc.type.zhi = NEUMANN
psi.bc.type.zlo = NEUMANN


model.E = 3.70 
model.nu = 0.22


### Sliding walls
#bc.type = constant
#bc.constant.type.ylo    = trac trac
#bc.constant.type.xloylo = disp disp
#bc.constant.type.xlo    = disp disp
#bc.constant.type.xloyhi = disp disp
#bc.constant.type.yhi    = trac trac
#bc.constant.type.xhi    = disp trac
#bc.constant.type.xhiylo = disp trac
#bc.constant.type.xhiyhi = disp trac
#bc.constant.val.xhi    = 0 -0.01 
#bc.constant.val.xhiylo = 0 -0.01 
#bc.constant.val.xhiyhi = 0 -0.01
#interval = 10
#alpha = 100.0
#beta = 0.1 #0.5
#gamma = -100000.0
#L = 0.001
#volume0 = 0.5
#lambda = 100.0

### Cantilever with uniform load
#bc.type = constant
#bc.constant.type.xloylo = disp disp
#bc.constant.type.xlo    = disp disp
#bc.constant.type.xloyhi = disp disp
#bc.constant.type.ylo    = trac trac
#bc.constant.type.yhi    = trac trac
#bc.constant.type.xhi    = trac trac
#bc.constant.type.xhiylo = trac trac
#bc.constant.type.xhiyhi = trac trac
#bc.constant.val.ylo    = 0 -0.005

### Cantilever with point load concentrated at end
#bc.type = expression
#bc.expression.type.xloylo = disp disp
#bc.expression.type.xlo    = disp disp
#bc.expression.type.xloyhi = disp disp
#bc.expression.type.ylo    = trac trac
#bc.expression.type.yhi    = trac trac
#bc.expression.type.xhi    = trac trac
#bc.expression.type.xhiylo = trac trac
#bc.expression.type.xhiyhi = trac trac
#bc.expression.val.ylo = "0.0" "-0.01 * (x > 1.5)" 

### Canonical test case: cantilever with load at tip
#bc.type = expression
#bc.expression.type.xloylo = disp disp
#bc.expression.type.xlo    = disp disp
#bc.expression.type.xloyhi = disp disp
#bc.expression.type.ylo    = trac trac
#bc.expression.type.yhi    = trac trac
#bc.expression.type.xhi    = trac trac
#bc.expression.type.xhiylo = trac trac
#bc.expression.type.xhiyhi = trac trac
#bc.expression.val.yhi = "0.0" "0.0" 
#bc.expression.val.xhiylo = "0.0" "0.0"
#bc.expression.val.xhiyhi = "0.0" "0.0"
#bc.expression.val.ylo = "0.0" "0" 
#bc.expression.val.xhi = "0.0" "-0.1 * (y > 0.45) * (y < 0.55)" 

bc.type = constant
bc.constant.type.xlo    = disp disp disp
bc.constant.type.xloylo = disp disp disp
bc.constant.type.xloyhi = disp disp disp
bc.constant.type.zloxlo = disp disp disp
bc.constant.type.zhixlo = disp disp disp
bc.constant.type.xloylozlo    = disp disp disp
bc.constant.type.xloylozhi    = disp disp disp
bc.constant.type.xloyhizlo    = disp disp disp
bc.constant.type.xloyhizhi    = disp disp disp
bc.constant.type.ylo    = trac trac trac
bc.constant.type.yhi    = trac trac trac
bc.constant.type.zlo    = trac trac trac
bc.constant.type.zhi    = trac trac trac
bc.constant.type.xhi    = trac trac trac
bc.constant.type.xhiylo = trac trac trac
bc.constant.type.xhiyhi = trac trac trac
bc.constant.type.zloxhi = trac trac trac
bc.constant.type.zhixhi = trac trac trac
bc.constant.type.ylozlo = trac trac trac
bc.constant.type.ylozhi = trac trac trac
bc.constant.type.yhizlo = trac trac trac
bc.constant.type.yhizhi = trac trac trac
bc.constant.type.xhiylozlo = trac trac trac
bc.constant.type.xhiylozhi = trac trac trac
bc.constant.type.xhiyhizlo = trac trac trac
bc.constant.type.xhiyhizhi = trac trac trac
#bc.expression.val.xhi = "0.0" "-0.1 * (y > 0.45) * (y < 0.55)"  "0.0"
bc.constant.val.xhi = 0.0 -0.1 0.0

#bc.type = tension_test
#bc.tension_test.type = uniaxial_stress
#bc.tension_test.trac=(0,1:0,0.01)


interval = 1
alpha = 200.
beta = 0.05 
gamma = -50000.0
L.str = 0.005 #0.01 
#volume0 = 0.5
volume0 = 0.25
lambda = 400.0

eta_ref_threshold = 0.05

elasticop.small= 0.01
solver.verbose = 3
solver.nriters = 1
solver.fixed_iter=1000
print_residual=1
elastic_ref_threshold = 100000
solver.bottom_solver = smoother
solver.tol_abs = 1E-16 # This is very important for near-singular problems!!!

zero_out_displacement = 1
